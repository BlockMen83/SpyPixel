<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Pixel Dashboard</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>Pixel Dashboard</h1>
    <section class="create-pixel-section">
        <h2>Create Tracking Pixel</h2>
        <form method="POST" action="/">
            <label for="recipient">Recipient Email:</label>
            <input type="email" id="recipient" name="recipient" required><br><br>
            <input type="submit" value="Generate Pixel">
        </form>
    </section>
    
    {% for pixel_id, pixel_data in email_data.items() %}
    <section class="pixel-data-section">
        <div class="header">
            <h2>Pixel ID: {{ pixel_id }}</h2>
            <form method="POST" action="{{ url_for('delete_pixel', pixel_id=pixel_id) }}">
                <input type="submit" value="Delete Pixel">
            </form>
        </div>
        <p>Pixel URL: <a href="{{ url_for('tracking_pixel') }}?id={{ pixel_id }}" target="_blank">{{ url_for('tracking_pixel', _external=True) }}?id={{ pixel_id }}</a></p>
        <table>
            <thead>
                <tr>
                    <th>Email Recipient</th>
                    <th>Last Accessed</th>
                    <th>Access Count</th>  <!-- New column for access count -->
                </tr>
            </thead>
            <tbody>
                {% for item in pixel_data %}
                    <tr>
                        <td>{{ item[0] }}</td>
                        <td>{{ item[1] }}</td>
                        <td>{{ item[2] }}</td>  <!-- Display the access count -->
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </section>
    {% endfor %}
</body>
</html>
